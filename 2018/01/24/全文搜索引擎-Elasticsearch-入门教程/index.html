<!DOCTYPE html>
<html lang=zh>
<head>
    <meta charset="utf-8">
    
    <title>搜索引擎之Elasticsearch | 夏浅安のブログ</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="全文搜索属于最常见的需求，开源的 Elasticsearch （以下简称 Elastic）是目前全文搜索引擎的首选。 它可以快速地储存、搜索和分析海量数据。维基百科、Stack Overflow、Github都采用它。">
<meta name="keywords" content="Elasticsearch">
<meta property="og:type" content="article">
<meta property="og:title" content="搜索引擎之Elasticsearch">
<meta property="og:url" content="http://github.com/b2stry/2018/01/24/全文搜索引擎-Elasticsearch-入门教程/index.html">
<meta property="og:site_name" content="夏浅安のブログ">
<meta property="og:description" content="全文搜索属于最常见的需求，开源的 Elasticsearch （以下简称 Elastic）是目前全文搜索引擎的首选。 它可以快速地储存、搜索和分析海量数据。维基百科、Stack Overflow、Github都采用它。">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://timgsa.baidu.com/timg?image&quality=80&size=b10000_10000&sec=1511497590&di=a256061d5ee986f05f807193ba5ff0ac&src=http://openskill.cn/uploads/article/20161015/0f32aeff3ccf8e5dc3d196ee8fd45d56.png">
<meta property="og:updated_time" content="2018-02-21T13:33:23.058Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="搜索引擎之Elasticsearch">
<meta name="twitter:description" content="全文搜索属于最常见的需求，开源的 Elasticsearch （以下简称 Elastic）是目前全文搜索引擎的首选。 它可以快速地储存、搜索和分析海量数据。维基百科、Stack Overflow、Github都采用它。">
<meta name="twitter:image" content="https://timgsa.baidu.com/timg?image&quality=80&size=b10000_10000&sec=1511497590&di=a256061d5ee986f05f807193ba5ff0ac&src=http://openskill.cn/uploads/article/20161015/0f32aeff3ccf8e5dc3d196ee8fd45d56.png">
    

    

    
        <link rel="icon" href="/images/yu.png" />
    

    <link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/libs/open-sans/styles.css">
    <link rel="stylesheet" href="/libs/source-code-pro/styles.css">

    <link rel="stylesheet" href="/css/style.css">

    <script src="/libs/jquery/2.1.3/jquery.min.js"></script>
    
    
        <link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css">
    
    
        <link rel="stylesheet" href="/libs/justified-gallery/justifiedGallery.min.css">
    
    
    
    
        <script>
var _hmt = _hmt || [];
(function() {
    var hm = document.createElement("script");
    hm.src = "//hm.baidu.com/hm.js?865692d8325f5ebc46f2007ac5a4f929";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
	
})();
</script>

    


</head>

<body>
    <div id="container">
        <header id="header">
    <div id="header-main" class="header-inner">
        <div class="outer">
            <a href="/" id="logo">
                <i class="logo"></i>
               
            </a>
            <nav id="main-nav">
                
                    <a class="main-nav-link" href="/.">Home</a>
                
                    <a class="main-nav-link" href="/archives">Archives</a>
                
                    <a class="main-nav-link" href="/categories">Categories</a>
                
                    <a class="main-nav-link" href="/tags">Tags</a>
                
                    <a class="main-nav-link" href="/about">About</a>
                
            </nav>
            
                
                <nav id="sub-nav">
                    <div class="profile" id="profile-nav">
                        <a id="profile-anchor" href="javascript:;">
                            <img class="avatar" src="/images/mianbao.png" />
                            <i class="fa fa-caret-down"></i>
                        </a>
                    </div>
                </nav>
            
            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="搜索" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="想要查找什么..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
        </div>
    </div>
    <div id="main-nav-mobile" class="header-sub header-inner">
        <table class="menu outer">
            <tr>
                
                    <td><a class="main-nav-link" href="/.">Home</a></td>
                
                    <td><a class="main-nav-link" href="/archives">Archives</a></td>
                
                    <td><a class="main-nav-link" href="/categories">Categories</a></td>
                
                    <td><a class="main-nav-link" href="/tags">Tags</a></td>
                
                    <td><a class="main-nav-link" href="/about">About</a></td>
                
                <td>
                    
    <div class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="搜索" />
    </div>

                </td>
            </tr>
        </table>
    </div>
</header>

        <div class="outer">
            
                

<aside id="profile">
    <div class="inner profile-inner">
        <div class="base-info profile-block">
            <img id="avatar" src="/images/mianbao.png" />
            <h2 id="name">ShallowAn</h2>
            <h3 id="title">世界远比你想象的更精彩,<br>别放弃!</h3>
            <span id="location"><i class="fa fa-map-marker"></i>中国, 长沙</span>
            <a style="margin:20px 50px 10px" id="follow" target="_blank" href="https://github.com/b2stry/">关注</a>
        </div>
        <div class="article-info profile-block">
            <div class="article-info-block">
                43
                <span>文章</span>
            </div>
            <div class="article-info-block">
                36
                <span>标签</span>
            </div>
        </div>
        
        <div class="profile-block social-links">
            <table>
                <tr>
                    
                    
                    <td>
                        <a href="http://main.shallowan.cn" target="_blank" title="home" class=tooltip>
                            <i class="fa fa-home"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="http://47.93.242.254:8888/mytwitter/" target="_blank" title="twitter" class=tooltip>
                            <i class="fa fa-twitter"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="https://weibo.com/shallowAn" target="_blank" title="weibo" class=tooltip>
                            <i class="fa fa-weibo"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="https://www.linkedin.com/in/%E9%9C%88-%E5%88%98-250b7b152/" target="_blank" title="linkedin" class=tooltip>
                            <i class="fa fa-linkedin"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="javascript:window.open('http://www.shallowan.cn/imgrepo/wechatcode.png')" target="_blank" title="weixin" class=tooltip>
                            <i class="fa fa-weixin"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="https://github.com/b2stry/" target="_blank" title="github" class=tooltip>
                            <i class="fa fa-github"></i>
                        </a>
                    </td>
                    
                </tr>
            </table>
        </div>
        
    </div>
</aside>

            
            <section id="main"><article id="post-全文搜索引擎-Elasticsearch-入门教程" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
            
	
		<img src="https://timgsa.baidu.com/timg?image&quality=80&size=b10000_10000&sec=1511497590&di=a256061d5ee986f05f807193ba5ff0ac&src=http://openskill.cn/uploads/article/20161015/0f32aeff3ccf8e5dc3d196ee8fd45d56.png" class="article-banner" />
	



        
        
            <header class="article-header">
                
    
        <h1 class="article-title" itemprop="name">
            搜索引擎之Elasticsearch
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2018/01/24/全文搜索引擎-Elasticsearch-入门教程/">
            <time datetime="2018-01-24T04:24:00.000Z" itemprop="datePublished">2018-01-24</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/Elasticsearch/">Elasticsearch</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/Elasticsearch/">Elasticsearch</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <p>全文搜索属于最常见的需求，开源的 <code>Elasticsearch</code> （以下简称 <code>Elastic</code>）是目前全文搜索引擎的首选。</p>
<p><code>它可以快速地储存、搜索和分析海量数据</code>。<code>维基百科</code>、<code>Stack Overflow</code>、<code>Github</code>都采用它。<br><a id="more"></a><br><code>Elastic</code> 的底层是开源库 <code>Lucene</code>。但是，你没法直接用 <code>Lucene</code>，必须自己写代码去调用它的接口。<code>Elastic</code> 是 <code>Lucene</code> 的封装，提供了 <code>REST API</code> 的操作接口，开箱即用。</p>
<p>本文从零开始，讲解如何使用 <code>Elastic</code> 搭建自己的全文搜索引擎。每一步都有详细的说明，大家跟着做就能学会。</p>
<h3 id="一、安装"><a href="#一、安装" class="headerlink" title="一、安装"></a>一、安装</h3><p><code>Elastic</code> 需要 <code>Java 8</code> 环境。如果你的机器还没安装 <code>Java</code>，可以参考这篇文章，注意要保证环境变量<code>JAVA_HOME</code>正确设置。<br>安装完 <code>Java</code>，就可以跟着官方文档安装 <code>Elastic</code>。直接下载压缩包比较简单。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-5.5.1.zip</div><div class="line">$ unzip elasticsearch-5.5.1.zip</div><div class="line">$ <span class="built_in">cd</span> elasticsearch-5.5.1/</div></pre></td></tr></table></figure></p>
<p>接着，进入解压后的目录，运行下面的命令，启动<code>Elastic</code>。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ ./bin/elasticsearch</div></pre></td></tr></table></figure></p>
<p>如果这时报错”<code>max virtual memory areas vm.maxmapcount [65530] is too low</code>“，要运行下面的命令。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ sudo sysctl -w vm.max_map_count=262144</div></pre></td></tr></table></figure></p>
<p>如果一切正常，<code>Elastic</code> 就会在默认的<code>9200</code>端口运行。这时，打开另一个命令行窗口，请求该端口，会得到说明信息。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ curl localhost:9200</div></pre></td></tr></table></figure></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"name"</span> : <span class="string">"atntrTf"</span>,</div><div class="line">  <span class="attr">"cluster_name"</span> : <span class="string">"elasticsearch"</span>,</div><div class="line">  <span class="attr">"cluster_uuid"</span> : <span class="string">"tf9250XhQ6ee4h7YI11anA"</span>,</div><div class="line">  <span class="attr">"version"</span> : &#123;</div><div class="line">    <span class="attr">"number"</span> : <span class="string">"5.5.1"</span>,</div><div class="line">    <span class="attr">"build_hash"</span> : <span class="string">"19c13d0"</span>,</div><div class="line">    <span class="attr">"build_date"</span> : <span class="string">"2017-07-18T20:44:24.823Z"</span>,</div><div class="line">    <span class="attr">"build_snapshot"</span> : <span class="literal">false</span>,</div><div class="line">    <span class="attr">"lucene_version"</span> : <span class="string">"6.6.0"</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">"tagline"</span> : <span class="string">"You Know, for Search"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>上面代码中，请求<code>9200</code>端口，<code>Elastic</code> 返回一个 <code>JSON</code>对象，包含当前节点、集群、版本等信息。</p>
<p>按下 <code>Ctrl + C</code>，<code>Elastic</code> 就会停止运行。</p>
<p>默认情况下，<code>Elastic</code> 只允许本机访问，如果需要远程访问，可以修改 <code>Elastic</code> 安装目录的<code>config/elasticsearch.yml</code>文件，去掉<code>network.host</code>的注释，将它的值改成<code>0.0.0.0</code>，然后重新启动 <code>Elastic</code>。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">network.host: 0.0.0.0</div></pre></td></tr></table></figure></p>
<p>上面代码中，设成<code>0.0.0.0</code>让任何人都可以访问。线上服务不要这样设置，要设成<code>具体的 IP</code>。</p>
<h3 id="二、基本概念"><a href="#二、基本概念" class="headerlink" title="二、基本概念"></a>二、基本概念</h3><h4 id="2-1-Node-与-Cluster"><a href="#2-1-Node-与-Cluster" class="headerlink" title="2.1 Node 与 Cluster"></a>2.1 Node 与 Cluster</h4><p><code>Elastic</code>本质上是一个分布式数据库，允许多台服务器协同工作，每台服务器可以运行多个 <code>Elastic</code> 实例。<br>单个 <code>Elastic</code> 实例称为一个节点（<code>node</code>）。一组节点构成一个集群（<code>cluster</code>）。</p>
<h3 id="2-2-Index"><a href="#2-2-Index" class="headerlink" title="2.2 Index"></a>2.2 Index</h3><p><code>Elastic</code> 会索引所有字段，经过处理后写入一个反向索引（<code>Inverted Index</code>）。查找数据的时候，直接查找该索引。</p>
<p>所以，<code>Elastic</code> 数据管理的顶层单位就叫做 <code>Index</code>（索引）。它是单个数据库的同义词。每个 <code>Index</code> （即数据库）的名字必须是小写。<br>下面的命令可以查看当前节点的所有 <code>Index</code>。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ curl -X GET &apos;http://localhost:9200/_cat/indices?v&apos;</div></pre></td></tr></table></figure></p>
<h4 id="2-3-Document"><a href="#2-3-Document" class="headerlink" title="2.3 Document"></a>2.3 Document</h4><p><code>Index</code> 里面单条的记录称为 <code>Document</code>（文档）。许多条 <code>Document</code> 构成了一个 <code>Index</code>。<br><code>Document</code> 使用 <code>JSON</code> 格式表示，下面是一个例子。<br><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"user"</span>: <span class="string">"张三"</span>,</div><div class="line">  <span class="attr">"title"</span>: <span class="string">"工程师"</span>,</div><div class="line">  <span class="attr">"desc"</span>: <span class="string">"数据库管理"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>同一个 <code>Index</code> 里面的 <code>Document</code>，不要求有相同的结构（<code>scheme</code>），但是最好保持相同，这样有利于提高搜索效率。</p>
<h4 id="2-4-Type"><a href="#2-4-Type" class="headerlink" title="2.4 Type"></a>2.4 Type</h4><p><code>Document</code> 可以分组，比如<code>weather</code>这个 <code>Index</code> 里面，可以按城市分组（北京和上海），也可以按气候分组（晴天和雨天）。这种分组就叫做 <code>Type</code>，它是虚拟的逻辑分组，用来过滤 <code>Document</code>。</p>
<p>不同的 <code>Type</code> 应该有相似的结构（<code>schema</code>），举例来说，id字段不能在这个组是字符串，在另一个组是数值。这是与关系型数据库的表的一个区别。性质完全不同的数据（比如<code>products</code>和<code>logs</code>）应该存成两个 <code>Index</code>，而不是一个 <code>Index</code> 里面的两个 <code>Type</code>（虽然可以做到）。<br>下面的命令可以列出每个 <code>Index</code> 所包含的 <code>Type</code>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ curl &apos;localhost:9200/_mapping?pretty=true&apos;</div></pre></td></tr></table></figure>
<p>根据规划，<code>Elastic 6.x</code> 版只允许每个<code>Index</code> 包含一个<code>Type</code>，<code>7.x</code>版将会彻底移除 <code>Type</code>。</p>
<h3 id="三、新建和删除-Index"><a href="#三、新建和删除-Index" class="headerlink" title="三、新建和删除 Index"></a>三、新建和删除 Index</h3><p>新建<code>Index</code>，可以直接向<code>Elastic</code>服务器发出 <code>PUT</code> 请求。下面的例子是新建一个名叫<code>weather</code>的<code>Index</code>。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ curl -X PUT &apos;localhost:9200/weather&apos;</div></pre></td></tr></table></figure></p>
<p>服务器返回一个 <code>JSON</code> 对象，里面的<code>acknowledged</code>字段表示操作成功。<br><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"acknowledged"</span>:<span class="literal">true</span>,</div><div class="line">  <span class="attr">"shards_acknowledged"</span>:<span class="literal">true</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>然后，我们发出 <code>DELETE</code> 请求，删除这个 <code>Index</code>。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ curl -X DELETE &apos;localhost:9200/weather&apos;</div></pre></td></tr></table></figure></p>
<h3 id="四、中文分词设置"><a href="#四、中文分词设置" class="headerlink" title="四、中文分词设置"></a>四、中文分词设置</h3><p>首先，安装中文分词插件。这里使用的是 <code>ik</code>，也可以考虑其他插件（比如 <code>smartcn</code>）。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ ./bin/elasticsearch-plugin install https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v5.5.1/elasticsearch-analysis-ik-5.5.1.zip</div></pre></td></tr></table></figure></p>
<p>上面代码安装的是<code>5.5.1</code>版的插件，与 <code>Elastic 5.5.1</code> 配合使用。</p>
<p>接着，重新启动 <code>Elastic</code>，就会自动加载这个新安装的插件。</p>
<p>然后，新建一个 <code>Index</code>，指定需要分词的字段。这一步根据数据结构而异，下面的命令只针对本文。基本上，凡是需要搜索的中文字段，都要单独设置一下。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">$ curl -X PUT &apos;localhost:9200/accounts&apos; -d &apos;</div><div class="line">&#123;</div><div class="line">  &quot;mappings&quot;: &#123;</div><div class="line">    &quot;person&quot;: &#123;</div><div class="line">      &quot;properties&quot;: &#123;</div><div class="line">        &quot;user&quot;: &#123;</div><div class="line">          &quot;type&quot;: &quot;text&quot;,</div><div class="line">          &quot;analyzer&quot;: &quot;ik_max_word&quot;,</div><div class="line">          &quot;search_analyzer&quot;: &quot;ik_max_word&quot;</div><div class="line">        &#125;,</div><div class="line">        &quot;title&quot;: &#123;</div><div class="line">          &quot;type&quot;: &quot;text&quot;,</div><div class="line">          &quot;analyzer&quot;: &quot;ik_max_word&quot;,</div><div class="line">          &quot;search_analyzer&quot;: &quot;ik_max_word&quot;</div><div class="line">        &#125;,</div><div class="line">        &quot;desc&quot;: &#123;</div><div class="line">          &quot;type&quot;: &quot;text&quot;,</div><div class="line">          &quot;analyzer&quot;: &quot;ik_max_word&quot;,</div><div class="line">          &quot;search_analyzer&quot;: &quot;ik_max_word&quot;</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;&apos;</div></pre></td></tr></table></figure></p>
<p>上面代码中，首先新建一个名称为<code>accounts</code>的<code>Index</code>，里面有一个名称为<code>person</code>的 <code>Type</code>。<code>person</code>有三个字段。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">user</div><div class="line">title</div><div class="line">desc</div></pre></td></tr></table></figure></p>
<p>这三个字段都是中文，而且类型都是文本（<code>text</code>），所以需要指定中文分词器，不能使用默认的英文分词器。</p>
<p><code>Elastic</code> 的分词器称为 <code>analyzer</code>。我们对每个字段指定分词器。<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">"user": &#123;</div><div class="line">  "type": "text",</div><div class="line">  "analyzer": "ik_max_word",</div><div class="line">  "search_analyzer": "ik_max_word"</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>上面代码中，<code>analyzer</code>是字段文本的分词器，<code>search_analyzer</code>是搜索词的分词器。<code>ik_max_word</code>分词器是插件<code>ik</code>提供的，可以对文本进行最大数量的分词。</p>
<h3 id="五、数据操作"><a href="#五、数据操作" class="headerlink" title="五、数据操作"></a>五、数据操作</h3><h4 id="5-1-新增记录"><a href="#5-1-新增记录" class="headerlink" title="5.1 新增记录"></a>5.1 新增记录</h4><p>向指定的 <code>/Index/Type</code> 发送<code>PUT</code> 请求，就可以在<code>Index</code> 里面新增一条记录。比如，向<code>/accounts/person</code>发送请求，就可以新增一条人员记录。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ curl -X PUT &apos;localhost:9200/accounts/person/1&apos; -d &apos;</div><div class="line">&#123;</div><div class="line">  &quot;user&quot;: &quot;张三&quot;,</div><div class="line">  &quot;title&quot;: &quot;工程师&quot;,</div><div class="line">  &quot;desc&quot;: &quot;数据库管理&quot;</div><div class="line">&#125;&apos;</div></pre></td></tr></table></figure></p>
<p>服务器返回的 <code>JSON</code> 对象，会给出 <code>Index</code>、<code>Type</code>、<code>Id</code>、<code>Version</code> 等信息。<br><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"_index"</span>:<span class="string">"accounts"</span>,</div><div class="line">  <span class="attr">"_type"</span>:<span class="string">"person"</span>,</div><div class="line">  <span class="attr">"_id"</span>:<span class="string">"1"</span>,</div><div class="line">  <span class="attr">"_version"</span>:<span class="number">1</span>,</div><div class="line">  <span class="attr">"result"</span>:<span class="string">"created"</span>,</div><div class="line">  <span class="attr">"_shards"</span>:&#123;<span class="attr">"total"</span>:<span class="number">2</span>,<span class="attr">"successful"</span>:<span class="number">1</span>,<span class="attr">"failed"</span>:<span class="number">0</span>&#125;,</div><div class="line">  <span class="attr">"created"</span>:<span class="literal">true</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>如果你仔细看，会发现请求路径是<code>/accounts/person/1</code>，最后的<code>1</code>是该条记录的<br><code>Id</code>。它不一定是数字，任意字符串（比如<code>abc</code>）都可以。</p>
<p>新增记录的时候，也可以不指定 <code>Id</code>，这时要改成 <code>POST</code> 请求。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ curl -X POST &apos;localhost:9200/accounts/person&apos; -d &apos;</div><div class="line">&#123;</div><div class="line">  &quot;user&quot;: &quot;李四&quot;,</div><div class="line">  &quot;title&quot;: &quot;工程师&quot;,</div><div class="line">  &quot;desc&quot;: &quot;系统管理&quot;</div><div class="line">&#125;&apos;</div></pre></td></tr></table></figure></p>
<p>上面代码中，向<code>/accounts/person</code>发出一个 <code>POST</code> 请求，添加一个记录。这时，服务器返回的 <code>JSON</code> 对象里面，<code>_id</code>字段就是一个随机字符串。<br><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"_index"</span>:<span class="string">"accounts"</span>,</div><div class="line">  <span class="attr">"_type"</span>:<span class="string">"person"</span>,</div><div class="line">  <span class="attr">"_id"</span>:<span class="string">"AV3qGfrC6jMbsbXb6k1p"</span>,</div><div class="line">  <span class="attr">"_version"</span>:<span class="number">1</span>,</div><div class="line">  <span class="attr">"result"</span>:<span class="string">"created"</span>,</div><div class="line">  <span class="attr">"_shards"</span>:&#123;<span class="attr">"total"</span>:<span class="number">2</span>,<span class="attr">"successful"</span>:<span class="number">1</span>,<span class="attr">"failed"</span>:<span class="number">0</span>&#125;,</div><div class="line">  <span class="attr">"created"</span>:<span class="literal">true</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>注意，如果没有先创建 <code>Index</code>（这个例子是<code>accounts</code>），直接执行上面的命令，<code>Elastic</code> 也不会报错，而是直接生成指定的 <code>Index</code>。所以，打字的时候要小心，不要写错 <code>Index</code> 的名称。<br>5.2 查看记录<br>向<code>/Index/Type/Id</code>发出 <code>GET</code> 请求，就可以查看这条记录。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ curl &apos;localhost:9200/accounts/person/1?pretty=true&apos;</div></pre></td></tr></table></figure></p>
<p>上面代码请求查看<code>/accounts/person/1</code>这条记录，<code>URL</code> 的参数<code>pretty=true</code>表示以易读的格式返回。</p>
<p>返回的数据中，<code>found</code>字段表示查询成功，<code>_source</code>字段返回原始记录。<br><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"_index"</span> : <span class="string">"accounts"</span>,</div><div class="line">  <span class="attr">"_type"</span> : <span class="string">"person"</span>,</div><div class="line">  <span class="attr">"_id"</span> : <span class="string">"1"</span>,</div><div class="line">  <span class="attr">"_version"</span> : <span class="number">1</span>,</div><div class="line">  <span class="attr">"found"</span> : <span class="literal">true</span>,</div><div class="line">  <span class="attr">"_source"</span> : &#123;</div><div class="line">    <span class="attr">"user"</span> : <span class="string">"张三"</span>,</div><div class="line">    <span class="attr">"title"</span> : <span class="string">"工程师"</span>,</div><div class="line">    <span class="attr">"desc"</span> : <span class="string">"数据库管理"</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>如果 <code>Id</code> 不正确，就查不到数据，<code>found</code>字段就是<code>false</code>。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ curl &apos;localhost:9200/weather/beijing/abc?pretty=true&apos;</div></pre></td></tr></table></figure></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"_index"</span> : <span class="string">"accounts"</span>,</div><div class="line">  <span class="attr">"_type"</span> : <span class="string">"person"</span>,</div><div class="line">  <span class="attr">"_id"</span> : <span class="string">"abc"</span>,</div><div class="line">  <span class="attr">"found"</span> : <span class="literal">false</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="5-3-删除记录"><a href="#5-3-删除记录" class="headerlink" title="5.3 删除记录"></a>5.3 删除记录</h4><p>删除记录就是发出 <code>DELETE</code> 请求。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ curl -X DELETE &apos;localhost:9200/accounts/person/1&apos;</div></pre></td></tr></table></figure></p>
<p>这里先不要删除这条记录，后面还要用到。</p>
<h4 id="5-4-更新记录"><a href="#5-4-更新记录" class="headerlink" title="5.4 更新记录"></a>5.4 更新记录</h4><p>更新记录就是使用 <code>PUT</code> 请求，重新发送一次数据。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ curl -X PUT &apos;localhost:9200/accounts/person/1&apos; -d &apos;</div><div class="line">&#123;</div><div class="line">    &quot;user&quot; : &quot;张三&quot;,</div><div class="line">    &quot;title&quot; : &quot;工程师&quot;,</div><div class="line">    &quot;desc&quot; : &quot;数据库管理，软件开发&quot;</div><div class="line">&#125;&apos;</div></pre></td></tr></table></figure></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"_index"</span>:<span class="string">"accounts"</span>,</div><div class="line">  <span class="attr">"_type"</span>:<span class="string">"person"</span>,</div><div class="line">  <span class="attr">"_id"</span>:<span class="string">"1"</span>,</div><div class="line">  <span class="attr">"_version"</span>:<span class="number">2</span>,</div><div class="line">  <span class="attr">"result"</span>:<span class="string">"updated"</span>,</div><div class="line">  <span class="attr">"_shards"</span>:&#123;<span class="attr">"total"</span>:<span class="number">2</span>,<span class="attr">"successful"</span>:<span class="number">1</span>,<span class="attr">"failed"</span>:<span class="number">0</span>&#125;,</div><div class="line">  <span class="attr">"created"</span>:<span class="literal">false</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>上面代码中，我们将原始数据从”数据库管理”改成”数据库管理，软件开发”。 返回结果里面，有几个字段发生了变化。<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">"_version" : 2,</div><div class="line">"result" : "updated",</div><div class="line">"created" : false</div></pre></td></tr></table></figure></p>
<p>可以看到，记录的 <code>Id</code> 没变，但是版本（<code>version</code>）从<code>1</code>变成<code>2</code>，操作类型（<code>result</code>）从<code>created</code>变成<code>updated</code>，<code>created</code>字段变成<code>false</code>，因为这次不是新建记录。</p>
<h3 id="六、数据查询"><a href="#六、数据查询" class="headerlink" title="六、数据查询"></a>六、数据查询</h3><h4 id="6-1-返回所有记录"><a href="#6-1-返回所有记录" class="headerlink" title="6.1 返回所有记录"></a>6.1 返回所有记录</h4><p>使用 <code>GET</code> 方法，直接请求<code>/Index/Type/_search</code>，就会返回所有记录。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ curl &apos;localhost:9200/accounts/person/_search&apos;</div></pre></td></tr></table></figure></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"took"</span>:<span class="number">2</span>,</div><div class="line">  <span class="attr">"timed_out"</span>:<span class="literal">false</span>,</div><div class="line">  <span class="attr">"_shards"</span>:&#123;<span class="attr">"total"</span>:<span class="number">5</span>,<span class="attr">"successful"</span>:<span class="number">5</span>,<span class="attr">"failed"</span>:<span class="number">0</span>&#125;,</div><div class="line">  <span class="attr">"hits"</span>:&#123;</div><div class="line">    <span class="attr">"total"</span>:<span class="number">2</span>,</div><div class="line">    <span class="attr">"max_score"</span>:<span class="number">1.0</span>,</div><div class="line">    <span class="attr">"hits"</span>:[</div><div class="line">      &#123;</div><div class="line">        <span class="attr">"_index"</span>:<span class="string">"accounts"</span>,</div><div class="line">        <span class="attr">"_type"</span>:<span class="string">"person"</span>,</div><div class="line">        <span class="attr">"_id"</span>:<span class="string">"AV3qGfrC6jMbsbXb6k1p"</span>,</div><div class="line">        <span class="attr">"_score"</span>:<span class="number">1.0</span>,</div><div class="line">        <span class="attr">"_source"</span>: &#123;</div><div class="line">          <span class="attr">"user"</span>: <span class="string">"李四"</span>,</div><div class="line">          <span class="attr">"title"</span>: <span class="string">"工程师"</span>,</div><div class="line">          <span class="attr">"desc"</span>: <span class="string">"系统管理"</span></div><div class="line">        &#125;</div><div class="line">      &#125;,</div><div class="line">      &#123;</div><div class="line">        <span class="attr">"_index"</span>:<span class="string">"accounts"</span>,</div><div class="line">        <span class="attr">"_type"</span>:<span class="string">"person"</span>,</div><div class="line">        <span class="attr">"_id"</span>:<span class="string">"1"</span>,</div><div class="line">        <span class="attr">"_score"</span>:<span class="number">1.0</span>,</div><div class="line">        <span class="attr">"_source"</span>: &#123;</div><div class="line">          <span class="attr">"user"</span> : <span class="string">"张三"</span>,</div><div class="line">          <span class="attr">"title"</span> : <span class="string">"工程师"</span>,</div><div class="line">          <span class="attr">"desc"</span> : <span class="string">"数据库管理，软件开发"</span></div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    ]</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>上面代码中，返回结果的 <code>took</code>字段表示该操作的耗时（单位为毫秒），<code>timed_out</code>字段表示是否超时，<code>hits</code>字段表示命中的记录，里面子字段的含义如下。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">total：返回记录数，本例是2条。</div><div class="line">max_score：最高的匹配程度，本例是1.0。</div><div class="line">hits：返回的记录组成的数组。</div></pre></td></tr></table></figure></p>
<p>返回的记录中，每条记录都有一个<code>_score</code>字段，表示匹配的程序，默认是按照这个字段降序排列。</p>
<h4 id="6-2-全文搜索"><a href="#6-2-全文搜索" class="headerlink" title="6.2 全文搜索"></a>6.2 全文搜索</h4><p><code>Elastic</code> 的查询非常特别，使用自己的查询语法，要求 <code>GET</code> 请求带有数据体。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ curl &apos;localhost:9200/accounts/person/_search&apos;  -d &apos;</div><div class="line">&#123;</div><div class="line">  &quot;query&quot; : &#123; &quot;match&quot; : &#123; &quot;desc&quot; : &quot;软件&quot; &#125;&#125;</div><div class="line">&#125;&apos;</div></pre></td></tr></table></figure></p>
<p>上面代码使用 <code>Match</code> 查询，指定的匹配条件是<code>desc</code>字段里面包含”软件”这个词。返回结果如下。<br><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"took"</span>:<span class="number">3</span>,</div><div class="line">  <span class="attr">"timed_out"</span>:<span class="literal">false</span>,</div><div class="line">  <span class="attr">"_shards"</span>:&#123;<span class="attr">"total"</span>:<span class="number">5</span>,<span class="attr">"successful"</span>:<span class="number">5</span>,<span class="attr">"failed"</span>:<span class="number">0</span>&#125;,</div><div class="line">  <span class="attr">"hits"</span>:&#123;</div><div class="line">    <span class="attr">"total"</span>:<span class="number">1</span>,</div><div class="line">    <span class="attr">"max_score"</span>:<span class="number">0.28582606</span>,</div><div class="line">    <span class="attr">"hits"</span>:[</div><div class="line">      &#123;</div><div class="line">        <span class="attr">"_index"</span>:<span class="string">"accounts"</span>,</div><div class="line">        <span class="attr">"_type"</span>:<span class="string">"person"</span>,</div><div class="line">        <span class="attr">"_id"</span>:<span class="string">"1"</span>,</div><div class="line">        <span class="attr">"_score"</span>:<span class="number">0.28582606</span>,</div><div class="line">        <span class="attr">"_source"</span>: &#123;</div><div class="line">          <span class="attr">"user"</span> : <span class="string">"张三"</span>,</div><div class="line">          <span class="attr">"title"</span> : <span class="string">"工程师"</span>,</div><div class="line">          <span class="attr">"desc"</span> : <span class="string">"数据库管理，软件开发"</span></div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    ]</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><code>Elastic</code> 默认一次返回<code>10</code>条结果，可以通过<code>size</code>字段改变这个设置。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ curl &apos;localhost:9200/accounts/person/_search&apos;  -d &apos;</div><div class="line">&#123;</div><div class="line">  &quot;query&quot; : &#123; &quot;match&quot; : &#123; &quot;desc&quot; : &quot;管理&quot; &#125;&#125;,</div><div class="line">  &quot;size&quot;: 1</div><div class="line">&#125;&apos;</div></pre></td></tr></table></figure></p>
<p>上面代码指定，每次只返回一条结果。</p>
<p>还可以通过<code>from</code>字段，指定位移。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ curl &apos;localhost:9200/accounts/person/_search&apos;  -d &apos;</div><div class="line">&#123;</div><div class="line">  &quot;query&quot; : &#123; &quot;match&quot; : &#123; &quot;desc&quot; : &quot;管理&quot; &#125;&#125;,</div><div class="line">  &quot;from&quot;: 1,</div><div class="line">  &quot;size&quot;: 1</div><div class="line">&#125;&apos;</div></pre></td></tr></table></figure></p>
<p>上面代码指定，从位置<code>1</code>开始（默认是从位置<code>0</code>开始），只返回一条结果。</p>
<h4 id="6-3-逻辑运算"><a href="#6-3-逻辑运算" class="headerlink" title="6.3 逻辑运算"></a>6.3 逻辑运算</h4><p>如果有多个搜索关键字， <code>Elastic</code> 认为它们是<code>or</code>关系。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ curl &apos;localhost:9200/accounts/person/_search&apos;  -d &apos;</div><div class="line">&#123;</div><div class="line">  &quot;query&quot; : &#123; &quot;match&quot; : &#123; &quot;desc&quot; : &quot;软件 系统&quot; &#125;&#125;</div><div class="line">&#125;&apos;</div></pre></td></tr></table></figure></p>
<p>上面代码搜索的是软件 <code>or</code> 系统。</p>
<p>如果要执行多个关键词的<code>and</code>搜索，必须使用<code>布尔查询</code>。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">$ curl &apos;localhost:9200/accounts/person/_search&apos;  -d &apos;</div><div class="line">&#123;</div><div class="line">  &quot;query&quot;: &#123;</div><div class="line">    &quot;bool&quot;: &#123;</div><div class="line">      &quot;must&quot;: [</div><div class="line">        &#123; &quot;match&quot;: &#123; &quot;desc&quot;: &quot;软件&quot; &#125; &#125;,</div><div class="line">        &#123; &quot;match&quot;: &#123; &quot;desc&quot;: &quot;系统&quot; &#125; &#125;</div><div class="line">      ]</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;&apos;</div></pre></td></tr></table></figure></p>
<h5 id="ps-本地快速搭建集群"><a href="#ps-本地快速搭建集群" class="headerlink" title="ps:本地快速搭建集群"></a>ps:本地快速搭建集群</h5><h5 id="1、-elasticsearch"><a href="#1、-elasticsearch" class="headerlink" title="1、./elasticsearch"></a>1、./elasticsearch</h5><h5 id="2、-elasticsearch-Ehttp-port-8200-Epath-data-node2"><a href="#2、-elasticsearch-Ehttp-port-8200-Epath-data-node2" class="headerlink" title="2、./elasticsearch -Ehttp.port=8200 -Epath.data=node2"></a>2、./elasticsearch -Ehttp.port=8200 -Epath.data=node2</h5><h5 id="3、-elasticsearch-Ehttp-port-7200-Epath-data-node3"><a href="#3、-elasticsearch-Ehttp-port-7200-Epath-data-node3" class="headerlink" title="3、./elasticsearch -Ehttp.port=7200 -Epath.data=node3"></a>3、./elasticsearch -Ehttp.port=7200 -Epath.data=node3</h5><h3 id="七、参考链接"><a href="#七、参考链接" class="headerlink" title="七、参考链接"></a>七、参考链接</h3><p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/getting-started.html" target="_blank" rel="external">ElasticSearch 官方手册</a></p>
<p><a href="https://www.elastic.co/blog/a-practical-introduction-to-elasticsearch" target="_blank" rel="external">A Practical Introduction to Elasticsearch</a></p>
<blockquote>
<p>作者： 阮一峰<br><br>原文链接：<a href="http://www.ruanyifeng.com/blog/2017/08/elasticsearch.html" target="_blank" rel="external">http://www.ruanyifeng.com/blog/2017/08/elasticsearch.html</a></p>
</blockquote>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="http://github.com/b2stry/2018/01/24/全文搜索引擎-Elasticsearch-入门教程/" data-id="cjjgu43rk001zzgqegstqawk6" class="article-share-link"><i class="fa fa-share"></i>分享</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    

        </footer>
    </div>
    
        
<nav id="article-nav">
    
        <a href="/2018/01/24/分布式和集群区别？什么是云计算平台？分布式的应用场景？/" id="article-nav-newer" class="article-nav-link-wrap">
            <strong class="article-nav-caption">上一篇</strong>
            <div class="article-nav-title">
                
                    分布式和集群区别？什么是云计算平台？分布式的应用场景？
                
            </div>
        </a>
    
    
        <a href="/2018/01/16/慕课网-Spring-Boot技术栈博客企业前后端-Spring Data JPA/" id="article-nav-older" class="article-nav-link-wrap">
            <strong class="article-nav-caption">下一篇</strong>
            <div class="article-nav-title">慕课网---Spring Boot企业级博客系统实战(数据持久化)</div>
        </a>
    
</nav>


    
</article>


    
    

</section>
            
                
<aside id="sidebar">
   
        
    <div class="widget-wrap">
        <h3 class="widget-title">最新文章</h3>
        <div class="widget">
            <ul id="recent-post" class="">
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/9420/04/02/《阿里感悟》如何在三年内成长为一名技术专家？/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/读书/">读书</a></p>
                            <p class="item-title"><a href="/9420/04/02/《阿里感悟》如何在三年内成长为一名技术专家？/" class="title">【置顶】《阿里感悟》如何在三年内成长为一名技术专家？</a></p>
                            <p class="item-date"><time datetime="9420-04-02T07:14:07.000Z" itemprop="datePublished">9420-04-02</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2018/07/11/不止代码/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/不止代码/">不止代码</a></p>
                            <p class="item-title"><a href="/2018/07/11/不止代码/" class="title">不止代码</a></p>
                            <p class="item-date"><time datetime="2018-07-11T07:58:12.000Z" itemprop="datePublished">2018-07-11</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2018/03/21/远程通信的几种选择/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/远程通信/">远程通信</a></p>
                            <p class="item-title"><a href="/2018/03/21/远程通信的几种选择/" class="title">远程通信的几种选择</a></p>
                            <p class="item-date"><time datetime="2018-03-21T14:19:26.000Z" itemprop="datePublished">2018-03-21</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2018/03/17/Tomcat-性能调优/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/tomcat调优/">tomcat调优</a></p>
                            <p class="item-title"><a href="/2018/03/17/Tomcat-性能调优/" class="title">Tomcat 性能调优</a></p>
                            <p class="item-date"><time datetime="2018-03-17T14:53:21.000Z" itemprop="datePublished">2018-03-17</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2018/03/13/Map中的hash/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/hash/">hash</a></p>
                            <p class="item-title"><a href="/2018/03/13/Map中的hash/" class="title">Map中的hash()</a></p>
                            <p class="item-date"><time datetime="2018-03-13T11:08:46.000Z" itemprop="datePublished">2018-03-13</time></p>
                        </div>
                    </li>
                
            </ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">分类</h3>
        <div class="widget">
            <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Ajax/">Ajax</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Elasticsearch/">Elasticsearch</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Js/">Js</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Mysql/">Mysql</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Shell/">Shell</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Spring-Boot/">Spring Boot</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/activemq/">activemq</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/algorithm/">algorithm</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/command/">command</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/docker/">docker</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/fetch/">fetch</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/hash/">hash</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/interview/">interview</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/jsr303/">jsr303</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/kafka/">kafka</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/network/">network</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/rabbitmq/">rabbitmq</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/redis/">redis</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/regex/">regex</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/spring/">spring</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/sql/">sql</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/swagger/">swagger</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/thymeleaf/">thymeleaf</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/tomcat调优/">tomcat调优</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/不止代码/">不止代码</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/消息中间件/">消息中间件</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/读书/">读书</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/远程通信/">远程通信</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/集群/">集群</a><span class="category-list-count">1</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/集群/分布式/">分布式</a><span class="category-list-count">1</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/集群/分布式/云计算/">云计算</a><span class="category-list-count">1</span></li></ul></li></ul></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">归档</h3>
        <div class="widget">
            <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/9420/04/">April 9420</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a><span class="archive-list-count">2</span></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">标签</h3>
        <div class="widget">
            <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ajax/">Ajax</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Elasticsearch/">Elasticsearch</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JSP/">JSP</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/">Java</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/">Python</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spring-Boot/">Spring Boot</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/">docker</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fetch/">fetch</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hash/">hash</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jsr303/">jsr303</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/">mysql</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/redis/">redis</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shell/">shell</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring/">spring</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sql/">sql</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/swagger/">swagger</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/thymeleaf/">thymeleaf</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tomcat/">tomcat</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tomcat调优/">tomcat调优</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vim/">vim</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/一键评教/">一键评教</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/不止代码/">不止代码</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/云计算/">云计算</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/分布式/">分布式</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/正则表达式/">正则表达式</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/消息中间件/">消息中间件</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/算法/">算法</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/计算机网络/">计算机网络</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/读书/">读书</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/远程通信/">远程通信</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/集群/">集群</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/面试/">面试</a><span class="tag-list-count">1</span></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">标签云</h3>
        <div class="widget tagcloud">
            <a href="/tags/Ajax/" style="font-size: 13.33px;">Ajax</a> <a href="/tags/Elasticsearch/" style="font-size: 10px;">Elasticsearch</a> <a href="/tags/JSP/" style="font-size: 10px;">JSP</a> <a href="/tags/Java/" style="font-size: 13.33px;">Java</a> <a href="/tags/Python/" style="font-size: 10px;">Python</a> <a href="/tags/Spring-Boot/" style="font-size: 16.67px;">Spring Boot</a> <a href="/tags/docker/" style="font-size: 10px;">docker</a> <a href="/tags/fetch/" style="font-size: 10px;">fetch</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/hash/" style="font-size: 10px;">hash</a> <a href="/tags/java/" style="font-size: 13.33px;">java</a> <a href="/tags/jsr303/" style="font-size: 10px;">jsr303</a> <a href="/tags/linux/" style="font-size: 13.33px;">linux</a> <a href="/tags/mysql/" style="font-size: 10px;">mysql</a> <a href="/tags/python/" style="font-size: 13.33px;">python</a> <a href="/tags/redis/" style="font-size: 10px;">redis</a> <a href="/tags/shell/" style="font-size: 13.33px;">shell</a> <a href="/tags/spring/" style="font-size: 10px;">spring</a> <a href="/tags/sql/" style="font-size: 10px;">sql</a> <a href="/tags/swagger/" style="font-size: 10px;">swagger</a> <a href="/tags/thymeleaf/" style="font-size: 10px;">thymeleaf</a> <a href="/tags/tomcat/" style="font-size: 10px;">tomcat</a> <a href="/tags/tomcat调优/" style="font-size: 10px;">tomcat调优</a> <a href="/tags/vim/" style="font-size: 10px;">vim</a> <a href="/tags/一键评教/" style="font-size: 10px;">一键评教</a> <a href="/tags/不止代码/" style="font-size: 10px;">不止代码</a> <a href="/tags/云计算/" style="font-size: 10px;">云计算</a> <a href="/tags/分布式/" style="font-size: 10px;">分布式</a> <a href="/tags/正则表达式/" style="font-size: 10px;">正则表达式</a> <a href="/tags/消息中间件/" style="font-size: 20px;">消息中间件</a> <a href="/tags/算法/" style="font-size: 13.33px;">算法</a> <a href="/tags/计算机网络/" style="font-size: 10px;">计算机网络</a> <a href="/tags/读书/" style="font-size: 10px;">读书</a> <a href="/tags/远程通信/" style="font-size: 10px;">远程通信</a> <a href="/tags/集群/" style="font-size: 10px;">集群</a> <a href="/tags/面试/" style="font-size: 10px;">面试</a>
        </div>
    </div>

    
        
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">友情链接(排名不分先后)</h3>
        <div class="widget">
            <ul>
                
                    <li>
                        <a target="_blank" href="http://ifeve.com/">并发编程网</a>
                    </li>
                
                    <li>
                        <a target="_blank" href="http://www.sivan0222.cn">吴晓文</a>
                    </li>
                
                    <li>
                        <a target="_blank" href="http://www.rxdonny.com">唐仁鑫</a>
                    </li>
                
            </ul>
        </div>
    </div>


    
    <div id="toTop" class="fa fa-angle-up"></div>
</aside>

            
        </div>
        <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<footer id="footer">
	
    <div class="outer">
    	<a target="_blank" href="https://github.com/b2stry"><span class="fa-stack fa-lg">
                                <i class="fa fa-github fa-stack-2x fa-inverse" style="color:#898d92"></i></span></a>
        <div id="footer-info" class="inner">
            Copyright&nbsp;&copy; 2018 <a href="https://github.com/B2stry" target="_blank">Shallow An</a>  &nbsp;&nbsp;<br><span id="busuanzi_container_site_pv" style="font-size:13px"> 
  		pv: <span id="busuanzi_value_site_pv" style="font-size:10px"></span>
	</span><br>&nbsp;&nbsp;いつからか好きになっていました<br>中心藏之，何日忘之<br><br>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="http://github.com/ppoffice" target="_blank">PPOffice</a>
        </div>
    </div>
</footer>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?95a2d1c2cf767a8efae55252dd5e5de4";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

        


    
        <script src="/libs/lightgallery/js/lightgallery.min.js"></script>
        <script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script>
        <script src="/libs/lightgallery/js/lg-pager.min.js"></script>
        <script src="/libs/lightgallery/js/lg-autoplay.min.js"></script>
        <script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script>
        <script src="/libs/lightgallery/js/lg-zoom.min.js"></script>
        <script src="/libs/lightgallery/js/lg-hash.min.js"></script>
        <script src="/libs/lightgallery/js/lg-share.min.js"></script>
        <script src="/libs/lightgallery/js/lg-video.min.js"></script>
    
    
        <script src="/libs/justified-gallery/jquery.justifiedGallery.min.js"></script>
    
    
        <script type="text/x-mathjax-config">
            MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    



<!-- Custom Scripts -->
<script src="/js/main.js"></script>

    </div>
</body>
</html>